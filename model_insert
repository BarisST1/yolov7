import torch
from models.experimental import attempt_load


model_path='/root/yolov7/rtuk.pt'
model=attempt_load('/root/yolov7/rtuk.pt',map_location=torch.device('cpu'))
model.eval()



# Modelin dedektör katmanını alın (IDetect katmanı)
detect_layer = model.model[-1]

# Çıkış kanallarını alın ve anchor box sayısına bölün (3 anchor varsayıyoruz)
num_classes = detect_layer.m[0].out_channels // 3 - 5
print(model)
print(f"Model {num_classes} sınıfa sahiptir.") 

# for name,param in model.named_parameters():
  #  print(f"Layer: {name} |Size:{param.size()}|Values:{param[:2]}\n")

print("model basarıyla yuklendi")


if hasattr(model, 'names'):
 classes = model.names
 print(classes)
else:
   print("Sınıf isimlerine erişim sağlanamadı.")
